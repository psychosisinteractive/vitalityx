\hypertarget{a00056}{}\section{libc/gdt.c File Reference}
\label{a00056}\index{libc/gdt.\+c@{libc/gdt.\+c}}
{\ttfamily \#include \char`\"{}gdt.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}vitality/inline.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}types.\+h\char`\"{}}\newline
Include dependency graph for gdt.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{a00056_a86bb50044169930202cc403376ef40c3_a86bb50044169930202cc403376ef40c3}{init\+\_\+gdt} ()
\begin{DoxyCompactList}\small\item\em Loads the G\+DT (Global Descriptor Table) \end{DoxyCompactList}\item 
void \hyperlink{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}{gdt\+\_\+set\+\_\+gate} (\hyperlink{a00092_ad838970452fe561cb8e0550cac5336be_ad838970452fe561cb8e0550cac5336be}{sint32\+\_\+t} num, \hyperlink{a00092_a435d1572bf3f880d55459d9805097f62_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{a00065_a0523cedff47e2441fc198b7770ec5d3f_a0523cedff47e2441fc198b7770ec5d3f}{base}, \hyperlink{a00092_a435d1572bf3f880d55459d9805097f62_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{a00065_ab28e82ae69032cb4ad3ec3a0be3d7129_ab28e82ae69032cb4ad3ec3a0be3d7129}{limit}, \hyperlink{a00092_aba7bc1797add20fe3efdf37ced1182c5_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{a00059_a8b0d6200bc639dd37ff68847a0adde5f_a8b0d6200bc639dd37ff68847a0adde5f}{access}, \hyperlink{a00092_aba7bc1797add20fe3efdf37ced1182c5_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} gran)
\begin{DoxyCompactList}\small\item\em Set the value of one G\+DT entry. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}\label{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}} 
\index{gdt.\+c@{gdt.\+c}!gdt\+\_\+set\+\_\+gate@{gdt\+\_\+set\+\_\+gate}}
\index{gdt\+\_\+set\+\_\+gate@{gdt\+\_\+set\+\_\+gate}!gdt.\+c@{gdt.\+c}}
\subsubsection{\texorpdfstring{gdt\+\_\+set\+\_\+gate()}{gdt\_set\_gate()}}
{\footnotesize\ttfamily void gdt\+\_\+set\+\_\+gate (\begin{DoxyParamCaption}\item[{\hyperlink{a00092_ad838970452fe561cb8e0550cac5336be_ad838970452fe561cb8e0550cac5336be}{sint32\+\_\+t}}]{num,  }\item[{\hyperlink{a00092_a435d1572bf3f880d55459d9805097f62_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{base,  }\item[{\hyperlink{a00092_a435d1572bf3f880d55459d9805097f62_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{limit,  }\item[{\hyperlink{a00092_aba7bc1797add20fe3efdf37ced1182c5_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{access,  }\item[{\hyperlink{a00092_aba7bc1797add20fe3efdf37ced1182c5_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{gran }\end{DoxyParamCaption})}



Set the value of one G\+DT entry. 



Definition at line 28 of file gdt.\+c.


\begin{DoxyCode}
29 \{
30    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_adba88eafea5f07167d181e4090cbcf49_adba88eafea5f07167d181e4090cbcf49}{base\_low}    = (\hyperlink{a00059_a0523cedff47e2441fc198b7770ec5d3f_a0523cedff47e2441fc198b7770ec5d3f}{base} & 0xFFFF);
31    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_a986d46963d3ccdbec85b3749c1e09abf_a986d46963d3ccdbec85b3749c1e09abf}{base\_middle} = (\hyperlink{a00059_a0523cedff47e2441fc198b7770ec5d3f_a0523cedff47e2441fc198b7770ec5d3f}{base} >> 16) & 0xFF;
32    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_aa08eedea9c0f707b9fa052b7567879c7_aa08eedea9c0f707b9fa052b7567879c7}{base\_high}   = (\hyperlink{a00059_a0523cedff47e2441fc198b7770ec5d3f_a0523cedff47e2441fc198b7770ec5d3f}{base} >> 24) & 0xFF;
33 
34    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_a6bbf5ad7af7b8e8e7f7c26ec74d8c1b2_a6bbf5ad7af7b8e8e7f7c26ec74d8c1b2}{limit\_low}   = (\hyperlink{a00059_ab28e82ae69032cb4ad3ec3a0be3d7129_ab28e82ae69032cb4ad3ec3a0be3d7129}{limit} & 0xFFFF);
35    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_a7fb7b3704e10434dbe64564416cf1a25_a7fb7b3704e10434dbe64564416cf1a25}{granularity} = (\hyperlink{a00059_ab28e82ae69032cb4ad3ec3a0be3d7129_ab28e82ae69032cb4ad3ec3a0be3d7129}{limit} >> 16) & 0x0F;
36 
37    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_a7fb7b3704e10434dbe64564416cf1a25_a7fb7b3704e10434dbe64564416cf1a25}{granularity} |= gran & 0xF0;
38    \hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries}[num].\hyperlink{a00142_ac07173385496c5b952e58ddc20f1cc99_ac07173385496c5b952e58ddc20f1cc99}{access}      = \hyperlink{a00059_a8b0d6200bc639dd37ff68847a0adde5f_a8b0d6200bc639dd37ff68847a0adde5f}{access};
39 \}
\end{DoxyCode}
\mbox{\Hypertarget{a00056_a86bb50044169930202cc403376ef40c3_a86bb50044169930202cc403376ef40c3}\label{a00056_a86bb50044169930202cc403376ef40c3_a86bb50044169930202cc403376ef40c3}} 
\index{gdt.\+c@{gdt.\+c}!init\+\_\+gdt@{init\+\_\+gdt}}
\index{init\+\_\+gdt@{init\+\_\+gdt}!gdt.\+c@{gdt.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+gdt()}{init\_gdt()}}
{\footnotesize\ttfamily void init\+\_\+gdt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Loads the G\+DT (Global Descriptor Table) 



Definition at line 9 of file gdt.\+c.


\begin{DoxyCode}
10 \{
11    \hyperlink{a00059_ab0888c07dfb9352ef76d05e63464cf0b_ab0888c07dfb9352ef76d05e63464cf0b}{gdt\_ptr}.\hyperlink{a00138_abf557ff0ca1cf3e130e8ab0086ab4ce6_abf557ff0ca1cf3e130e8ab0086ab4ce6}{limit} = (\textcolor{keyword}{sizeof}(\hyperlink{a00059_ab0b5c60e06a63669c783705278ff641e_ab0b5c60e06a63669c783705278ff641e}{gdt\_entry\_t}) * 5) - 1;
12    \hyperlink{a00059_ab0888c07dfb9352ef76d05e63464cf0b_ab0888c07dfb9352ef76d05e63464cf0b}{gdt\_ptr}.\hyperlink{a00138_a9b351f31bc261f3c2c3a87252350fb9c_a9b351f31bc261f3c2c3a87252350fb9c}{base}  = (\hyperlink{a00092_a435d1572bf3f880d55459d9805097f62_a435d1572bf3f880d55459d9805097f62}{uint32\_t})&\hyperlink{a00059_aa938d9ff79b4e6577a93f98e1ad1f917_aa938d9ff79b4e6577a93f98e1ad1f917}{gdt\_entries};
13 
14    \hyperlink{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}{gdt\_set\_gate}(0, 0, 0, 0, 0);                \textcolor{comment}{// Null segment}
15    \textcolor{comment}{// kernel}
16    \hyperlink{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}{gdt\_set\_gate}(1, 0, 0xFFFFFFFF, 0x9A, 0xCF); \textcolor{comment}{// Code segment}
17    \hyperlink{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}{gdt\_set\_gate}(2, 0, 0xFFFFFFFF, 0x92, 0xCF); \textcolor{comment}{// Data segment}
18    \textcolor{comment}{// user mode}
19    \hyperlink{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}{gdt\_set\_gate}(3, 0x00100000, 0x00EFFFFF, 0xFA, 0xCF); \textcolor{comment}{// User mode code segment}
20    \hyperlink{a00056_abcf0775ea602ace125ae809475b6d8bf_abcf0775ea602ace125ae809475b6d8bf}{gdt\_set\_gate}(4, 0x00100000, 0x00EFFFFF, 0xF2, 0xCF); \textcolor{comment}{// User mode data segment}
21 
22    \hyperlink{a00059_a62397fecbde23244b570ae632fe926fa_a62397fecbde23244b570ae632fe926fa}{gdt\_flush}((\hyperlink{a00092_a435d1572bf3f880d55459d9805097f62_a435d1572bf3f880d55459d9805097f62}{uint32\_t})&\hyperlink{a00059_ab0888c07dfb9352ef76d05e63464cf0b_ab0888c07dfb9352ef76d05e63464cf0b}{gdt\_ptr});
23 \}
\end{DoxyCode}
